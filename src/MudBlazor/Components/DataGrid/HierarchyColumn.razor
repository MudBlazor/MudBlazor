@namespace MudBlazor
@inherits MudComponentBase
@typeparam T

<TemplateColumn T="T" Tag="@("hierarchy-column")" Sortable="false" Resizable="false" ShowColumnOptions="false" HeaderStyle="width:0%"
    Hideable="Hideable" Hidden="Hidden" HiddenChanged="HiddenChanged"
    Filterable="false" Editable="false" DragAndDropEnabled="@DragAndDropEnabled">
    <CellTemplate>
         <MudIconButton 
            Class="ma-n3 pa-1"
            Icon="@(context.OpenHierarchies.Contains(context.Item) ?  OpenIcon : ClosedIcon)" 
            OnClick="context.Actions.ToggleHierarchyVisibilityForItemAsync"
            Size="@IconSize"
            Disabled="ButtonDisabledFunc.Invoke(context.Item)"/>
    </CellTemplate>
</TemplateColumn>

@code {
    [Parameter] public string ClosedIcon { get; set; } = Icons.Material.Filled.ChevronRight;
    [Parameter] public string OpenIcon { get; set; } = Icons.Material.Filled.ExpandMore;
    [Parameter] public Size IconSize { get; set; } = Size.Medium;
    [Parameter] public Func<T, bool> ButtonDisabledFunc { get; set; } = x => false;

    /// <summary>
    /// Determines whether this column can be hidden. This overrides the Hideable parameter on the DataGrid.
    /// </summary>
    [Parameter] public bool? Hideable { get; set; }

    [Parameter] public bool Hidden { get; set; }
    [Parameter] public EventCallback<bool> HiddenChanged { get; set; }
}
