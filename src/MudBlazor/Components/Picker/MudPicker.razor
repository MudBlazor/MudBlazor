@namespace MudBlazor
@using Microsoft.JSInterop
@using MudBlazor.Interop
@using MudBlazor.Utilities
@inherits MudBasePicker

<div class="@PickerClass">
    @if (PickerVariant != PickerVariant.Static)
    {
        @if (!IsRange) 
        { 
            <MudTextField Label="@Label" @bind-Text="@Value" HelperText="@HelperText" Variant="@InputVariant" ReadOnly="@(!Editable)" T="string"
                          @onclick="@(() => { if (!Editable) ToggleOpen(); })" OnAdornmentClick="ToggleOpen" Disabled="@Disabled" Adornment="@Adornment" AdornmentIcon="@InputIcon" IconSize="@IconSize" />
        }
        else 
        {
            <MudInputControl Label="@Label" Variant="@InputVariant" HelperText="@HelperText" Disabled="@Disabled" @onclick="@(() => { if (!Editable) ToggleOpen(); })">
                <InputContent>
                    <MudRangeInput @attributes="UserAttributes" InputType="@InputType.Text" Class="@PickerInputClass" Style="@Style" Variant="@InputVariant" ReadOnly="@(!Editable)" T="string"
                                   @bind-Text="@Value" Disabled=@Disabled Adornment="@Adornment" AdornmentIcon="@InputIcon" IconSize="@IconSize" OnAdornmentClick="ToggleOpen"/>
                </InputContent>
            </MudInputControl>
        }
    }
    <CascadingValue Value="@this" IsFixed="true">
        @if (IsOpen && PickerVariant != PickerVariant.Dialog)
        {
            <div @ref="_pickerPaperRef" class="@PickerPaperClass">
                <MudPaper @attributes="UserAttributes" Elevation="@_pickerElevation" Square="@_pickerSquare">
                    <div class="@PickerContainerClass">
                        @ChildContent
                    </div>
                </MudPaper>
            </div>
        }
        else if(IsOpen && PickerVariant == PickerVariant.Dialog)
        {
            <MudOverlay Visible="IsOpen" OnClick="@Close" DarkBackground="true" Class="mud-overlay-dialog">
                <MudPaper @attributes="UserAttributes" Class="@PickerPaperClass" Elevation="@_pickerElevation" Square="@_pickerSquare">
                    <div class="@PickerContainerClass">
                        @ChildContent
                    </div>
                </MudPaper>
            </MudOverlay>
        }
    </CascadingValue>
</div>
@if (PickerVariant == PickerVariant.Inline)
{
    <MudOverlay Visible="IsOpen" OnClick="@Close" LockScroll="false" />
}