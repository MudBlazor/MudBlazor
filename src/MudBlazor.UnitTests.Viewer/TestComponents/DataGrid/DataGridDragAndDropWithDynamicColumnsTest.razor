@namespace MudBlazor.UnitTests.TestComponents
@using System.Reflection;
@using System.Linq.Expressions;
<MudPopoverProvider></MudPopoverProvider>

<MudDataGrid Items="@_items" DragDropColumnReordering="true" DragIndicatorIcon="@Icons.Material.Filled.DragIndicator">
    <Columns>
        @foreach (var propertyColumn in _columnInfos)
        {
            <PropertyColumn DragAndDropEnabled="@propertyColumn.DragAndDropEnabled" Property="@propertyColumn.Property" Title="@propertyColumn.Title"></PropertyColumn>
        }
    </Columns>
</MudDataGrid>

@code {
    private IEnumerable<Model> _items = new List<Model>()
    {
        new Model("Sam", 56, Severity.Normal, false, null), 
        new Model("Alicia", 54, Severity.Info, null, null), 
        new Model("Ira", 27, Severity.Success, true, new DateTime(2011, 1, 2)),
        new Model("John", 32, Severity.Warning, false, null)
    };

    private List<ColumnInfo> _columnInfos = new List<ColumnInfo>();

    protected override void OnInitialized()
    {       
        Type modelType = typeof(Model);
        foreach (PropertyInfo propertyInfo in modelType.GetProperties())
        {
            _columnInfos.Add(new ColumnInfo(true, x => propertyInfo.GetValue(x), propertyInfo.Name));
        }        
    }

    public record Model (string Name, int? Age, Severity? Status, bool? Hired, DateTime? HiredOn);
    public record ColumnInfo(bool DragAndDropEnabled, Expression<Func<Model, object>> Property, string Title);
}
